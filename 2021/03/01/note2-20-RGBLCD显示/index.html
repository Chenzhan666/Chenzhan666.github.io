<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>note2.20-RGBLCD显示 | CHENZHAN</title><meta name="keywords" content="ARM(MX6U)"><meta name="author" content="Chenzhan666"><meta name="copyright" content="Chenzhan666"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="RGBLCD 显示LCD 和 eLCDIF 简介LCD 简介LCD 全称是 Liquid Crystal Display，是液晶显示器，LCD 的原理解释如下： LCD 的构造是在两片平行的玻璃基板当中放置液晶盒，下基板玻璃上设置 TFT（薄膜晶体管），上基板玻璃上设置彩色滤光片，通过 TFT 上的信号与电压改变来控制液晶分子的转动方向，从而达到控制每个像素点偏振光出射与否而达到显示目的  分">
<meta property="og:type" content="article">
<meta property="og:title" content="note2.20-RGBLCD显示">
<meta property="og:url" content="https://www.chenzhan.club/2021/03/01/note2-20-RGBLCD%E6%98%BE%E7%A4%BA/index.html">
<meta property="og:site_name" content="CHENZHAN">
<meta property="og:description" content="RGBLCD 显示LCD 和 eLCDIF 简介LCD 简介LCD 全称是 Liquid Crystal Display，是液晶显示器，LCD 的原理解释如下： LCD 的构造是在两片平行的玻璃基板当中放置液晶盒，下基板玻璃上设置 TFT（薄膜晶体管），上基板玻璃上设置彩色滤光片，通过 TFT 上的信号与电压改变来控制液晶分子的转动方向，从而达到控制每个像素点偏振光出射与否而达到显示目的  分">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i0.hdslb.com/bfs/article/4619e484017e9cf7bdea5f0c8fc052f8ee34994e.jpg@1320w_624h.webp">
<meta property="article:published_time" content="2021-02-28T16:02:57.000Z">
<meta property="article:modified_time" content="2021-03-07T13:54:44.229Z">
<meta property="article:author" content="Chenzhan666">
<meta property="article:tag" content="ARM(MX6U)">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i0.hdslb.com/bfs/article/4619e484017e9cf7bdea5f0c8fc052f8ee34994e.jpg@1320w_624h.webp"><link rel="shortcut icon" href="/Chenzhan666.github.io/img/favicon.png"><link rel="canonical" href="https://www.chenzhan.club/2021/03/01/note2-20-RGBLCD%E6%98%BE%E7%A4%BA/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/Chenzhan666.github.io/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/Chenzhan666.github.io/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-03-07 21:54:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/Chenzhan666.github.io/atom.xml" title="CHENZHAN" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/Chenzhan666.github.io/null" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/Chenzhan666.github.io/archives/"><div class="headline">文章</div><div class="length-num">31</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/Chenzhan666.github.io/tags/"><div class="headline">标签</div><div class="length-num">4</div></a></div></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i0.hdslb.com/bfs/article/4619e484017e9cf7bdea5f0c8fc052f8ee34994e.jpg@1320w_624h.webp')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/Chenzhan666.github.io/">CHENZHAN</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">note2.20-RGBLCD显示</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-02-28T16:02:57.000Z" title="发表于 2021-03-01 00:02:57">2021-03-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-03-07T13:54:44.229Z" title="更新于 2021-03-07 21:54:44">2021-03-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="note2.20-RGBLCD显示"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><meta name="referrer" content="no-referrer">

<h1 id="RGBLCD-显示"><a href="#RGBLCD-显示" class="headerlink" title="RGBLCD 显示"></a>RGBLCD 显示</h1><h2 id="LCD-和-eLCDIF-简介"><a href="#LCD-和-eLCDIF-简介" class="headerlink" title="LCD 和 eLCDIF 简介"></a>LCD 和 eLCDIF 简介</h2><h3 id="LCD-简介"><a href="#LCD-简介" class="headerlink" title="LCD 简介"></a>LCD 简介</h3><p>LCD 全称是 Liquid Crystal Display，是液晶显示器，LCD 的原理解释如下： LCD 的构造是在两片平行的玻璃基板当中放置液晶盒，下基板玻璃上设置 TFT（薄膜晶体管），上基板玻璃上设置彩色滤光片，通过 TFT 上的信号与电压改变来控制液晶分子的转动方向，从而达到控制每个像素点偏振光出射与否而达到显示目的</p>
<ul>
<li>分辨率</li>
</ul>
<p>LCD 显示器 720P、1080P、2K 或 4K ，就是 LCD 显示器分辨率。是由一个一个的像素点组成，像素点类似一个灯(在 OLED 显示器中，像素点就是一个小灯)，这个小灯是 RGB 灯，也就是由 R(红色)、G(绿色)和 B(蓝色)这三 种颜色组成的，而 RGB 就是光的三原色。1080P 的意思就是一个 LCD 屏幕上的像素数量是 1920*1080 个，也就是这个屏幕一列 1080 个像素点，一共 1920 列</p>
<p>1080P 显示器像素示意图中，X 轴就是 LCD 显示器的横轴，Y 轴就是显示器的竖轴。图中小方块就是像素点，一共有 1920*1080=2073600 个像素点。左上角的 A 点是第一个像素点，右下角的 C 点就是最后一个像素点。2K 就是 25601440 个像素点，4K 是 38402160 个像素点。在 LCD 尺寸不变的情况下，分辨率越高越清晰。分辨率不变的情况下，LCD 尺寸越小越清晰。衡量一款 LCD 的好坏，分辨率只是其中的一个参数，还有色彩还原程度、色彩偏离、亮 度、可视角度、屏幕刷新率等其他参数</p>
<ul>
<li>像素格式</li>
</ul>
<p>一个像素点相当于一个 RGB 小灯，通过控制 R、G、B 这三种颜色的亮度可以显示出各种各样的色彩。一般一个 R、 G、B 这三部分分别使用 8bit 的数据，那么一个像素点就是 8bit*3=24bit，也就是说一个像素点 3 个字节，这种像素格式称为 RGB888。如果在加入 8bit 的 Alpha(透明)通道的话一个像素点就是 32bit，也就是 4 个字节，这种像素格式称为 ARGB8888。ARGB8888 这种像素格式，一个像素占用 4 个字节的内存，这四个字节每个位的分配如图</p>
<p><img src="/Chenzhan666.github.io/.club//Personalwebsite\blog\myBlog\source_posts\note20-RGBLCD显示\image-20210301001603955.png" alt="image-20210301001603955"></p>
<p>图中，一个像素点是 4 个字节，其中 bit31<del>bit24 是 Alpha 通道，bit23</del>bit16 是 RED 通道，bit15<del>bit14 是 GREEN 通道，bit7</del>bit0 是 BLUE 通道。所以红色对应的值就是 0X00FF0000，蓝色对应的值就是 0X000000FF，绿色对应的值为 0X0000FF00。通过调节 R、G、 B的比例可以产生其它的颜色，比如0X00FFFF00就是黄色，0X00000000就是黑色，0X00FFFFFF 就是白色</p>
<ul>
<li>LCD 屏幕接口</li>
</ul>
<p>LCD 屏幕即显示器有很多种接口，比如显示器上常见的 VGA、HDMI、DP 等等， 但I.MX6U-ALPHA开发板不支持这些接口。I.MX6U-ALPHA支持RGB接口的LCD，RGBLCD 接口的信号线如表所示</p>
<table>
<thead>
<tr>
<th>信号线</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>R[7:0]</td>
<td>8 根红色数据线</td>
</tr>
<tr>
<td>G[7:0]</td>
<td>8 根绿色数据线</td>
</tr>
<tr>
<td>B[7:0]</td>
<td>8 根蓝色数据线</td>
</tr>
<tr>
<td>DE</td>
<td>数据使能线</td>
</tr>
<tr>
<td>VSYNC</td>
<td>垂直同步信号线</td>
</tr>
<tr>
<td>HSYNC</td>
<td>水平同步信号线</td>
</tr>
<tr>
<td>PCLK</td>
<td>像素时钟信号线</td>
</tr>
</tbody></table>
<p>表是RGBLCD的信号线，R[7:0]、G[7:0]和B[7:0]这24根是数据线，DE、VSYNC、 HSYNC 和 PCLK 这四根是控制信号线。RGB LCD 一般有两种驱动模式：DE 模式和 HV 模式， 这两个模式的区别是 DE 模式需要用到 DE 信号线，而 HV 模式不需要用到 DE 信号线，在 DE 模式下是可以不需要 HSYNC 信号线的，即使不接 HSYNC 信号线 LCD 也可以正常工作。 ALIENTEK 一共有三款 RGB LCD 屏幕，型号分别为：ATK-4342(4.3 寸，480 * 272)、ATK7084(7 寸，800 * 480)和 ATK-7016(7 寸，1024 * 600)</p>
<p><img src="/Chenzhan666.github.io/.club//Personalwebsite\blog\myBlog\source_posts\note20-RGBLCD显示\image-20210301002234070.png" alt="image-20210301002234070"></p>
<p> J1 是对外接口，是一个 40PIN 的 FPC 座（0.5mm 间距），通过 FPC 线，可以连接到 I.MX6U-ALPHA 开发板上面，从而实现和 I.MX6U 的连接。该接口十分完善，采用 RGB888 格式，并支持 DE&amp;HV 模式，还支持触摸屏和背光控制。右侧的几个电阻，可以用户自己选择。默认情况，R1 和 R6 焊接，设置 LCD_LR 和 LCD_UD，控制 LCD 的扫描方向，是从左到右，从上到下（横屏看）。而 LCD_R7/G7/B7 则用来设置 LCD 的 ID，由于 RGBLCD 没有读写寄存器，也就没有所谓的 ID，这里我们通过在模块上面，控制 R7/G7/B7 的 上/下拉，来自定义 LCD 模块的 ID，帮助 MCU 判断当前 LCD 面板的分辨率和相关参数，以提高程序兼容性。这几个位的设置关系如表所示：</p>
<p><img src="/Chenzhan666.github.io/.club//Personalwebsite\blog\myBlog\source_posts\note20-RGBLCD显示\image-20210301002350840.png" alt="image-20210301002350840"></p>
<p>ATK-7016 模块，就设置 M2:M0=010 即可。这样，我们在程序里面，读取 LCD_R7/G7/B7， 得到 M0:M2 的值，从而判断 RGBLCD 模块的型号，并执行不同的配置，即可实现不同 LCD 模 块的兼容</p>
<ul>
<li>LCD 时间参数</li>
</ul>
<p>LCD 扫描一帧图像由一行一行组成的。HSYNC 是水平同步信号，也叫做行同步信号，当产生此信号的话就表示开始显示新的一行了，所以此信号都是在图的最左边。当 VSYNC 信号是垂直同步信号，也叫做帧同步信号，当产生此信号的话就表示开始显示新的一帧图像了，所以此信号在图的左上角。 在图可以看到有一圈“黑边”，真正有效的显示区域是中间的白色部分。CRT 显示器后面是个电子枪，电子枪打出的电子撞 击到屏幕上的荧光物质使其发光。只要控制电子枪从左到右扫完一行(也就是扫描一行)，然后从上到下扫描完所有行，这样一帧图像就显示出来。显示一帧图像电子枪是按照 ‘Z’形在运动，当扫描速度很快的时候看起来就是一幅完成的画面了。 当显示完一行以后会发出 HSYNC 信号，此时电子枪就会关闭，然后迅速的移动到屏幕的 左边，当 HSYNC 信号结束以后就可以显示新的一行数据了，电子枪就会重新打开。在 HSYNC 信号结束到电子枪重新打开之间会插入一段延时，这段延时就是图中的 HBP。当显示完一行以后就会关闭电子枪等待 HSYNC 信号产生，关闭电子枪到 HSYNC 信号产生之间会插入一段延时，这段延时就是图中的 HFP 信号。同理，当显示完一帧图像以后电子枪也会关闭，然后等到 VSYNC 信号产生，期间也会加入一段延时，这段延时就是图中的 VFP。 VSYNC 信号产生，电子枪移动到左上角，当 VSYNC 信号结束以后电子枪重新打开，中间也会加入一段延时，这段延时就是图中的 VBP</p>
<p><img src="/Chenzhan666.github.io/.club//Personalwebsite\blog\myBlog\source_posts\note20-RGBLCD显示\image-20210301002857220.png" alt="image-20210301002857220"></p>
<p>HBP、HFP、VBP 和 VFP 是导致图 24.1.1.5 中黑边的原因，LCD 显示器， RGB LCD 屏幕内部是有一个 IC 的，发送一行或者一帧数据给 IC，IC 是需要反应时间的。通过这段反应 时间可以让 IC 识别到一行数据扫描完了，要换行了，或者一帧图像扫描完了，要开始下一帧图 像显示了。因此，在 LCD 屏幕中继续存在 HBP、HFP、VPB 和 VFP 这四个参数的主要目的是 为了锁定有效的像素数据。这四个时间是 LCD 重要的时间参数，后面编写 LCD 驱动的时候要 用到的，至于这四个时间参数具体值是多少，需要去查看所使用的 LCD 数据手册</p>
<ul>
<li>RGB LCD 屏幕时序</li>
</ul>
<p><img src="/Chenzhan666.github.io/.club//Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20210301003541074.png" alt="image-20210301003541074"></p>
<p><strong>HSYNC</strong>8：行同步信号，当此信号有效的话就表示开始显示新的一行数据，查阅所使用的 LCD 数据手册可以知道此信号是低电平有效还是高电平有效，假设此时是低电平有效</p>
<p><strong>HSPW</strong>：有些地方也叫做 thp，是 HSYNC 信号宽度，也就是 HSYNC 信号持续时间</p>
<p>HSYNC 信号不是一个脉冲，而是需要持续一段时间才是有效的，单位为 CLK</p>
<p><strong>HBP</strong>：有些地方叫做 thb，前面已经讲过了，术语叫做行同步信号后肩，单位是 CLK </p>
<p><strong>HOZVAL</strong>：有些地方叫做 thd，显示一行数据所需的时间，假如屏幕分辨率为 1024*600， 那么 HOZVAL 就是 1024，单位为 CLK</p>
<p><strong>HFP</strong>：有些地方叫做 thf，前面已经讲过了，术语叫做行同步信号前肩，单位是 CLK</p>
<p>当 HSYNC 信号发出以后，需要等待 HSPW+HBP 个 CLK 时间才会接收到真正有效的像素数据。当显示完一行数据以后需要等待 HFP 个 CLK 时间才能发出下一个 HSYNC 信号，所以 显示一行所需要的时间就是：HSPW + HBP + HOZVAL + HFP，一帧图像就是由很多个行组成的</p>
<p><img src="/Chenzhan666.github.io/.club//Personalwebsite\blog\myBlog\source_posts\note20-RGBLCD显示\image-20210301003753141.png" alt="image-20210301003753141"></p>
<p><strong>VSYNC</strong>：帧同步信号，当此信号有效的话就表示开始显示新的一帧数据，查阅所使用的 LCD 数据手册可以知道此信号是低电平有效还是高电平有效，假设此时是低电平有效</p>
<p><strong>VSPW</strong>：些地方也叫做 tvp，是 VSYNC 信号宽度，也就是 VSYNC 信号持续时间，单位为 1 行的时间</p>
<p><strong>VBP</strong>：有些地方叫做 tvb，前面已经讲过了，术语叫做帧同步信号后肩，单位为 1 行的时间 </p>
<p><strong>LINE</strong>：有些地方叫做 tvd，显示一帧有效数据所需的时间，假如屏幕分辨率为 1024*600， 那么 LINE 就是 600 行的时间</p>
<p><strong>VFP</strong>：有些地方叫做 tvf，前面已经讲过了，术语叫做帧同步信号前肩，单位为 1 行的时间</p>
<p>显示一帧所需要的时间就是：VSPW+VBP+LINE+VFP 个行时间，最终的计算公式： </p>
<p>T = (VSPW+VBP+LINE+VFP) * (HSPW + HBP + HOZVAL + HFP)</p>
<p>因此我们在配置一款 RGB LCD 的时候需要知道这几个参数：HOZVAL(屏幕有效宽度)、 LINE(屏幕有效高度)、HBP、HSPW、HFP、VSPW、VBP 和 VFP</p>
<ul>
<li>像素时钟</li>
</ul>
<p>像素时钟就是 RGB LCD 的时钟信号，以 ATK7016 这款屏幕为例，显示一帧图像所需要的时钟数就是： </p>
<p>= (VSPW+VBP+LINE+VFP) * (HSPW + HBP + HOZVAL + HFP) </p>
<p>= (3 + 20 + 600 + 12) * (20 + 140 + 1024 + 160) </p>
<p>= 635 * 1344 = 853440</p>
<p>显示一帧图像需要853440个时钟数，那么显示60帧就是：853440 * 60 = 51206400≈51.2M， 所以像素时钟就是 51.2MHz</p>
<p><strong>I.MX6U 的 eLCDIF 接口时钟图略</strong></p>
<p>以 ATK7016 屏幕所需的 51.2MHz 为例进行配置。 PLL5 频率设置涉及到四个寄存器：CCM_PLL_VIDEO、CCM_PLL_VIDEO_NUM、 CCM_PLL_VIDEO_DENOM 、 CCM_MISC2 。 其 中 CCM_PLL_VIDEO_NUM 和 CCM_PLL_VIDEO_DENOM 这两个寄存器是用于小数分频的，不使用小数分频，因此这两个寄存器设置为 0。 PLL5 的时钟计算公式如下： </p>
<p>PLL5_CLK = OSC24M * (loopDivider + (denominator / numerator)) / postDivider </p>
<p>不使用小数分频的话 PLL5 时钟计算公式就可以简化为 ： </p>
<p>PLL5_CLK = OSC24M * loopDivider / postDivider </p>
<p>OSC24M 就是 24MHz 的有源晶振</p>
<p>寄存器 CCM_PLL_VIDEO 用到的重要的位如下：</p>
<p>POST_DIV_SLECT(bit20:19)：此位和寄存器 CCM_ANALOG_CCMSC2 的 VIDEO_DIV 位共同决定了 postDivider，为 0 的话是 4 分频，为 1 的话是 2 分频，为 2 的话是 1 分频。设置为 2，也就是 1 分频</p>
<p>ENABLE(bit13)：PLL5(PLL_VIDEO)使能为 1 的话使能 PLL5，为 0 的话关闭 PLL5 DIV_SELECT(bit6:0)：loopDivider 值，范围为 27~54，设置为 32</p>
<p>寄存器 CCM_ANALOG_MISC2 的位 VIDEO_DIV(bit31:30)与寄存器 CCM_PLL_VIDEO 的位 POST_DIV_SLECT(bit20:19)共同决定了 postDivider，通过这两个的配合可以获得 2、4、8、16 分频。将 VIDEO_DIV 设置为 0，也就是 1 分频，因此 postDivider 就是 1，loopDivider 设 置为 32，PLL5 的时钟频率就是： </p>
<p>PLL5_CLK = OSC24M * loopDivider / postDivider </p>
<p>​                  = 24M * 32 / 1 </p>
<p>​                  = 768MHz</p>
<p>PLL5 此时为 768MHz，在经过图中的②和③进一步分频，设置②中为 3 分频，也 就是寄存器 CCM_CSCDR2 的位 LCDIF1_PRED(bit14:12)为 2。设置③中为 5 分频，就是寄存器 CCM_CBCMR 的位 LCDIF1_PODF(bit25:23)为 4。设置好以后最终进入到 LCDIF 的时钟频率就 是：768/3/5 =51.2MHz，这就是我们需要的像素时钟频率</p>
<ul>
<li>显存</li>
</ul>
<p>如果采用 ARGB8888 格式的话一个像素需要 4 个字节 的内存来存放像素数据，那么 1024 * 600 分辨率就需要 1024 * 600 * 4=2457600B≈2.4MB 内存。但 是 RGB LCD 内部是没有内存的，所以就需要在开发板上的 DDR3 中分出一段内存作为 RGB LCD 屏幕的显存，我们如果要在屏幕上显示什么图像的话直接操作这部分显存即可</p>
<h3 id="eLCDIF-接口"><a href="#eLCDIF-接口" class="headerlink" title="eLCDIF 接口"></a>eLCDIF 接口</h3><p>eLCDIF 是 I.MX6U 自带的液晶屏幕接口，用于连接 RGB LCD 接口的屏幕，eLCDIF 接口特性如下： </p>
<ol>
<li>支持 RGB LCD 的 DE 模式</li>
<li>支持 VSYNC 模式以实现高速数据传输</li>
<li>支持 ITU-R BT.656 格式的 4:2:2 的 YCbCr 数字视频，并且将其转换为模拟 TV 信号</li>
<li>支持 8/16/18/24/32 位 LCD</li>
</ol>
<p>eLCDIF 支持三种接口：MPU 接口、VSYNC 接口和 DOTCLK 接口，这三种接口区别如下： </p>
<ol>
<li><p>MPU 接口 MPU 接口用于在 I.MX6U 和 LCD 屏幕直接传输数据和命令，这个接口用于 6080/8080 接 口的 LCD 屏幕，如果寄存器 LCDIF_CTRL 的位 DOTCLK_MODE、DVI_MODE 和 VSYNC_MODE 都为 0 的话就表示 LCDIF 工作在 MPU 接口模式。关于 MPU 接口的详细信息以及时序参考《I.MX6ULL 参考手册》第 2150 页的“34.4.6 MPU Interface”小节</p>
</li>
<li><p>VSYNC 接口 VSYNC 接口时序和 MPU 接口时序基本一样， VSYNC 信号来作为帧同步，当 LCDIF_CTRL 的位 VSYNC_MODE 为 1 的时候此接口使能。关于 VSYNC 接口的详细信息请参 考《I.MX6ULL 参考手册》第 2152 页的“34.4.7 VSYNC Interface”小节</p>
</li>
<li><p>DOTCLK 接口DOTCLK 接口就是用来连接 RGB LCD 接口屏幕的， 它包括 VSYNC、HSYNC、DOTCLK 和 ENABLE(可选的)这四个信号，这样的接口通常被称为 RGB 接口</p>
</li>
</ol>
<ul>
<li>LCDIF_CTRL 寄存器</li>
<li>寄存器 LCDIF_CTRL1， 用 到 位 BYTE_PACKING_FORMAT(bit19:16)，此位用来决定在 32 位的数据中哪些字节的数据有效，默 认值为 0XF，也就是所有的字节有效，当为 0 的话表示所有的字节都无效</li>
<li>寄存器 LCDIF_TRANSFER_COUNT，用来设置所连接的 RGB LCD 屏幕分辨率大小</li>
<li>寄存器LCDIF_TRANSFER_COUNT分为两部分，高16位和低16位，高16位是V_COUNT， 是 LCD 的垂直分辨率</li>
<li>寄存器 LCDIF_VDCTRL0，这个寄存器是 VSYNC 和 DOTCLK 模式控制寄存器 0</li>
<li>寄存器 LCDIF_VDCTRL1，这个寄存器是 VSYNC 和 DOTCLK 模式控制寄 存器 1，此寄存器只有一个功能，用来设置 VSYNC 总周期，就是：屏幕高度+VSPW+VBP+VFP</li>
<li>寄存器 LCDIF_VDCTRL2，这个寄存器分为高 16 位和低 16 位两部分，高 16 位是 HSYNC_PULSE_WIDTH，用来设置 HSYNC 信号宽度，也就是 HSPW。低 16 位是 HSYNC_PERIOD，设置 HSYNC 总周期，就是：屏幕宽度+HSPW+HBP+HFP</li>
<li>寄存器 LCDIF_VDCTRL3</li>
<li>寄存器 LCDIF_VDCTRL4</li>
<li>寄存器 LCDIF_CUR_BUF 和 LCDIF_NEXT_BUF，这两个寄存器分别为当前 帧和下一帧缓冲区，也就是 LCD 显存。一般这两个寄存器保存同一个地址，也就是划分给 LCD 的显存首地址</li>
</ul>
<p>使用 I.MX6U 的 eLCDIF 接口来驱动 ALIENTEK 的 ATK7016 这款屏幕，配置步骤如下：</p>
<ol>
<li>初始化 LCD 所使用的 IO 首先肯定是初始化 LCD 所示使用的 IO，将其复用为 eLCDIF 接口 IO</li>
<li>设置 LCD 的像素时钟 查阅所使用的 LCD 屏幕数据手册，或者自己计算出的时钟像素，然后设置 CCM 相应的寄存器</li>
<li>配置 eLCDIF 接口 设置 LCDIF 的寄存器 CTRL、CTRL1、TRANSFER_COUNT、VDCTRL0~4、CUR_BUF 和 NEXT_BUF。根据 LCD 的数据手册设置相应的参数</li>
<li>编写 API 函数 驱动 LCD 屏幕的目的就是显示内容，所以需要编写一些基本的 API 函数，比如画点、画 线、画圆函数，字符串显示函数等</li>
</ol>
<hr>
<p>参考资料：正点原子</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Chenzhan666</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.chenzhan.club/2021/03/01/note2-20-RGBLCD%E6%98%BE%E7%A4%BA/">https://www.chenzhan.club/2021/03/01/note2-20-RGBLCD%E6%98%BE%E7%A4%BA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.chenzhan.club" target="_blank">CHENZHAN</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/Chenzhan666.github.io/tags/ARM-MX6U/">ARM(MX6U)</a></div><div class="post_share"><div class="social-share" data-image="https://i0.hdslb.com/bfs/article/4619e484017e9cf7bdea5f0c8fc052f8ee34994e.jpg@1320w_624h.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Chenzhan666.github.io/2021/03/01/note2-21-RTC%E5%AE%9E%E6%97%B6%E6%97%B6%E9%92%9F/"><img class="prev-cover" src="https://i0.hdslb.com/bfs/article/27bdacd1e9a5defa72cab581e643da8d54a5a005.jpg@1320w_928h.webp" onerror="onerror=null;src='/Chenzhan666.github.io/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">note2.21-RTC实时时钟</div></div></a></div><div class="next-post pull-right"><a href="/Chenzhan666.github.io/2021/02/28/note2-19-DDR3%E5%86%85%E5%AD%98%E8%8A%AF%E7%89%87%E5%AE%9E%E9%AA%8C/"><img class="next-cover" src="https://i0.hdslb.com/bfs/article/d8a5d2ec6089d075ff2783fffb83dfb1b5bf11c4.jpg@1320w_826h.webp" onerror="onerror=null;src='/Chenzhan666.github.io/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">note2.19-DDR3内存芯片实验</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/Chenzhan666.github.io/2021/02/14/note2-10-I-MX6U启动方式/" title="note2.10 I.MX6U启动方式"><img class="cover" src="https://i0.hdslb.com/bfs/article/c1f5404dfc142af3c96d83a1a37b4f32b3f84fef.jpg@1320w_934h.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-14</div><div class="title">note2.10 I.MX6U启动方式</div></div></a></div><div><a href="/Chenzhan666.github.io/2021/02/15/note2-13-蜂鸣器实验/" title="note2.13 蜂鸣器实验"><img class="cover" src="https://i0.hdslb.com/bfs/album/d9169dc108ec1dc6c330a5472858de36759703a5.jpg@518w.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-15</div><div class="title">note2.13 蜂鸣器实验</div></div></a></div><div><a href="/Chenzhan666.github.io/2021/02/17/note2-14-GPIO输入按键实验/" title="note2.14 GPIO输入按键实验"><img class="cover" src="https://i0.hdslb.com/bfs/album/aee4ce6332eff5bdc8c9ec4ce19c1d606c156d7f.jpg@518w.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-17</div><div class="title">note2.14 GPIO输入按键实验</div></div></a></div><div><a href="/Chenzhan666.github.io/2021/02/20/note2-15-主频和时钟配置实验/" title="note2.15 主频和时钟配置实验"><img class="cover" src="https://i0.hdslb.com/bfs/article/c045ee3a7675559c95272fd8865fd7161ae05549.jpg@1320w_742h.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-20</div><div class="title">note2.15 主频和时钟配置实验</div></div></a></div><div><a href="/Chenzhan666.github.io/2021/02/26/note2-17-EPIT定时器实验/" title="note2.17-EPIT定时器，按键消抖，高精度延时"><img class="cover" src="https://i0.hdslb.com/bfs/album/d186bc9ebd6166a0702afc3be8aced74148845b1.png@518w.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-26</div><div class="title">note2.17-EPIT定时器，按键消抖，高精度延时</div></div></a></div><div><a href="/Chenzhan666.github.io/2021/02/27/note2-18-UART串口通信/" title="note2.18-UART串口通信"><img class="cover" src="https://i0.hdslb.com/bfs/article/0efc347b8b2fab3bbc38b50abf506085c2aa185d.jpg@1200w_688h.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-27</div><div class="title">note2.18-UART串口通信</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/Chenzhan666.github.io/null" onerror="this.onerror=null;this.src='/Chenzhan666.github.io/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Chenzhan666</div><div class="author-info__description">演好你的剧本( ´･ω･)ﾉ(._.`)</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/Chenzhan666.github.io/archives/"><div class="headline">文章</div><div class="length-num">31</div></a></div><div class="card-info-data-item is-center"><a href="/Chenzhan666.github.io/tags/"><div class="headline">标签</div><div class="length-num">4</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RGBLCD-%E6%98%BE%E7%A4%BA"><span class="toc-number">1.</span> <span class="toc-text">RGBLCD 显示</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#LCD-%E5%92%8C-eLCDIF-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">LCD 和 eLCDIF 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LCD-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">LCD 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eLCDIF-%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.1.2.</span> <span class="toc-text">eLCDIF 接口</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Chenzhan666.github.io/2021/03/27/note4-31-rootfs%E6%A0%B9%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" title="note4.31-rootfs根文件系统"><img src="https://i0.hdslb.com/bfs/album/70f78b669890b61676ae026d8035d7ca62a9743e.jpg@518w.webp" onerror="this.onerror=null;this.src='/Chenzhan666.github.io/img/404.jpg'" alt="note4.31-rootfs根文件系统"/></a><div class="content"><a class="title" href="/Chenzhan666.github.io/2021/03/27/note4-31-rootfs%E6%A0%B9%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" title="note4.31-rootfs根文件系统">note4.31-rootfs根文件系统</a><time datetime="2021-03-27T07:48:23.000Z" title="发表于 2021-03-27 15:48:23">2021-03-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Chenzhan666.github.io/2021/03/23/note4-30-Linux%E5%86%85%E6%A0%B8%E7%A7%BB%E5%80%BC/" title="note4.30-Linux内核移值"><img src="https://i0.hdslb.com/bfs/album/cfbea7b6b809364917b9a33025146598e1e6de8b.png@518w.webp" onerror="this.onerror=null;this.src='/Chenzhan666.github.io/img/404.jpg'" alt="note4.30-Linux内核移值"/></a><div class="content"><a class="title" href="/Chenzhan666.github.io/2021/03/23/note4-30-Linux%E5%86%85%E6%A0%B8%E7%A7%BB%E5%80%BC/" title="note4.30-Linux内核移值">note4.30-Linux内核移值</a><time datetime="2021-03-23T12:54:25.000Z" title="发表于 2021-03-23 20:54:25">2021-03-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Chenzhan666.github.io/2021/03/17/note4-29-U-Boot%E5%86%85%E6%A0%B8%E7%A7%BB%E5%80%BC%E5%90%AF%E5%8A%A8/" title="note4.29-U-Boot内核移值启动"><img src="https://i0.hdslb.com/bfs/album/350178b826e31d6159e842b6e25c9c80d4115e1d.png@518w.webp" onerror="this.onerror=null;this.src='/Chenzhan666.github.io/img/404.jpg'" alt="note4.29-U-Boot内核移值启动"/></a><div class="content"><a class="title" href="/Chenzhan666.github.io/2021/03/17/note4-29-U-Boot%E5%86%85%E6%A0%B8%E7%A7%BB%E5%80%BC%E5%90%AF%E5%8A%A8/" title="note4.29-U-Boot内核移值启动">note4.29-U-Boot内核移值启动</a><time datetime="2021-03-17T07:01:00.000Z" title="发表于 2021-03-17 15:01:00">2021-03-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Chenzhan666.github.io/2021/03/13/note4-28-U-Boot/" title="note4.28-U-Boot"><img src="https://i0.hdslb.com/bfs/album/210b54e20bd1d14ff1e3edb020fa5a0ff719539d.jpg@518w.webp" onerror="this.onerror=null;this.src='/Chenzhan666.github.io/img/404.jpg'" alt="note4.28-U-Boot"/></a><div class="content"><a class="title" href="/Chenzhan666.github.io/2021/03/13/note4-28-U-Boot/" title="note4.28-U-Boot">note4.28-U-Boot</a><time datetime="2021-03-13T14:00:42.000Z" title="发表于 2021-03-13 22:00:42">2021-03-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Chenzhan666.github.io/2021/03/08/note3-27-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%A6%82%E5%BF%B5%E4%BA%8C/" title="note3.27-数据结构概念二"><img src="https://i0.hdslb.com/bfs/album/48b6bb190e3b0f7ba120145d741ba65f3b734367.png@518w.webp" onerror="this.onerror=null;this.src='/Chenzhan666.github.io/img/404.jpg'" alt="note3.27-数据结构概念二"/></a><div class="content"><a class="title" href="/Chenzhan666.github.io/2021/03/08/note3-27-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%A6%82%E5%BF%B5%E4%BA%8C/" title="note3.27-数据结构概念二">note3.27-数据结构概念二</a><time datetime="2021-03-08T13:44:00.000Z" title="发表于 2021-03-08 21:44:00">2021-03-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Chenzhan666</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/Chenzhan666.github.io/js/utils.js"></script><script src="/Chenzhan666.github.io/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/Chenzhan666.github.io/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/Chenzhan666.github.io/live2dw/assets/hibiki.model.json"},"display":{"position":"right","width":145,"height":315},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>